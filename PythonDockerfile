FROM alpine:3.18.2
WORKDIR /app
COPY ./tracer/ ./tracer
COPY api/python .
EXPOSE 8082
RUN apk add bcc-tools bcc-doc
RUN apk add py3-pip
RUN apk add strace
RUN pip install -r tracer/tracer/requirements.txt
RUN pip install uvicorn
RUN pip install -r requirements.txt
CMD python -u -m tracer.tracer.main 8082 & sleep 5; strace -o logs.txt uvicorn main:app --port 8082 --host 0.0.0.0
